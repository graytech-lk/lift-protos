syntax = "proto3";

package lift.payment.v1;

option go_package = "github.com/graytech-lk/lift-protos/gen/go/payment/v1;paymentv1";

import "google/protobuf/struct.proto";
import "google/protobuf/timestamp.proto";

message UserPaymentMethod {
  string id = 1;
  google.protobuf.Timestamp created_time = 2;
  google.protobuf.Timestamp updated_time = 3;
  string user_id = 4;
  string type = 5;
  string name = 6;
  string payment_method = 7;
  bool is_default = 8;
  google.protobuf.Struct extended_parameters = 9;
  int32 status = 10;
}

message ListUserPaymentMethodsRequest {
  string user_id = 1;
}

message ListUserPaymentMethodsResponse {
  repeated UserPaymentMethod methods = 1;
}

message GetPaymentMethodRequest {
  string user_id = 1;
  string payment_method_id = 2;
}

message GetPaymentMethodResponse {
  UserPaymentMethod method = 1;
}

message GetCorporatePaymentMethodRequest {
  string user_id = 1;
  string corporate_id = 2;
}

message GetCorporatePaymentMethodResponse {
  UserPaymentMethod method = 1;
}

message ListCorporatePaymentMethodsRequest {
  string corporate_id = 1;
  bool include_disabled = 2;
}

message ListCorporatePaymentMethodsResponse {
  repeated UserPaymentMethod methods = 1;
}

message UpdatePaymentMethodStatusRequest {
  string id = 1;
  int32 status = 2;
}

message UpdatePaymentMethodStatusResponse {
  UserPaymentMethod method = 1;
}

message Payment {
  string id = 1;
  string payment_type = 2;
  string user_payment_method = 3;
  string service_request_id = 4;
  double total_amount_after_discount = 5;
  google.protobuf.Timestamp created_time = 6;
  double total_amount_before_discount = 7;
  google.protobuf.Timestamp updated_time = 8;
  repeated PaymentEvent payment_events = 9;
}

message PaymentEvent {
  string id = 1;
  string payment_type = 2;
  string payment_id = 3;
  double amount = 4;
  string event_type = 5;
  google.protobuf.Timestamp created_time = 6;
  google.protobuf.Timestamp updated_time = 7;
  string gateway_reference_id = 8;
  string gateway_processed_status = 9;
}

message ListPaymentsByMethodRequest {
  repeated string payment_method_ids = 1;
  google.protobuf.Timestamp start_time = 2;
  google.protobuf.Timestamp end_time = 3;
}

message ListPaymentsByMethodResponse {
  repeated Payment payments = 1;
}

message InsertPaymentRequest {
  string service_request_id = 1;
  string user_payment_method = 2;
  string payment_type = 3;
  double total_amount_before_discount = 4;
  double total_amount_after_discount = 5;
  repeated PaymentEvent payment_events = 6;
}

message InsertPaymentResponse {
  Payment payment = 1;
}

message GetServiceRequestRequest {
  string service_request_id = 1;
}

message ServiceRequest {
  string id = 1;
  string status = 2;
}

message GetServiceRequestResponse {
  ServiceRequest request = 1;
}

message PromoCode {
  string id = 1;
  string promo_code = 2;
  string promo_type = 3;
  string promo_element = 4;
  google.protobuf.Timestamp start_time = 5;
  google.protobuf.Timestamp end_time = 6;
  string status = 7;
  string day_of_week = 8;
  string date_of_month = 9;
  string time_range = 10;
  int32 minimum_amount = 11;
  int32 maximum_discount_amount = 12;
  int32 min_utilization_count = 13;
  int32 max_utilization_count = 14;
  string eligibility_criteria = 15;
  string eligibility_eval_period = 16;
  string eligibility_operation = 17;
  int32 eligibility_value = 18;
  string eligible_payment_method = 19;
  double discount_amount = 20;
}

message GetPromoCodeRequest {
  string id = 1;
}

message GetPromoCodeResponse {
  PromoCode promocode = 1;
}

service PaymentMethodService {
  rpc ListUserPaymentMethods(ListUserPaymentMethodsRequest) returns (ListUserPaymentMethodsResponse);
  rpc GetPaymentMethod(GetPaymentMethodRequest) returns (GetPaymentMethodResponse);
  rpc GetCorporatePaymentMethod(GetCorporatePaymentMethodRequest) returns (GetCorporatePaymentMethodResponse);
  rpc ListCorporatePaymentMethods(ListCorporatePaymentMethodsRequest) returns (ListCorporatePaymentMethodsResponse);
  rpc UpdatePaymentMethodStatus(UpdatePaymentMethodStatusRequest) returns (UpdatePaymentMethodStatusResponse);
}

service PaymentService {
  rpc InsertPayment(InsertPaymentRequest) returns (InsertPaymentResponse);
  rpc ListPaymentsByMethod(ListPaymentsByMethodRequest) returns (ListPaymentsByMethodResponse);
  rpc GetServiceRequest(GetServiceRequestRequest) returns (GetServiceRequestResponse);
}

service PromoCodeService {
  rpc GetPromoCode(GetPromoCodeRequest) returns (GetPromoCodeResponse);
}


